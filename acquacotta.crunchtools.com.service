[Unit]
Description=Podman container - acquacotta.crunchtools.com

[Service]
Type=simple
EnvironmentFile=/srv/acquacotta.crunchtools.com/config/acquacotta.env
ExecStart=/usr/bin/podman run -i --read-only --rm \
    -p 172.105.19.17:8443:443 \
    --name acquacotta.crunchtools.com \
    -e XDG_DATA_HOME=/data \
    -e FLASK_SECRET_KEY=${FLASK_SECRET_KEY} \
    -e GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID} \
    -e GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET} \
    -v /srv/acquacotta.crunchtools.com/data:/data:Z \
    -v /srv/acquacotta.crunchtools.com/config/origin.crt:/etc/pki/tls/certs/origin.crt:ro,Z \
    -v /srv/acquacotta.crunchtools.com/config/origin.key:/etc/pki/tls/private/origin.key:ro,Z \
    --tmpfs /tmp \
    --tmpfs /run/httpd \
    --tmpfs /var/log/httpd \
    quay.io/fatherlinux/acquacotta:latest
ExecStop=/usr/bin/podman stop -t 3 acquacotta.crunchtools.com
ExecStopPost=/usr/bin/podman rm -f acquacotta.crunchtools.com
Restart=always

[Install]
WantedBy=multi-user.target
